{"dependencies":[{"name":"@babel/runtime/helpers/interopRequireDefault","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":71,"column":0,"index":2260}}],"key":"kslwqCIsh6ew+I1KeA1rlVRjsAk="}},{"name":"@babel/runtime/helpers/asyncToGenerator","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":71,"column":0,"index":2260}}],"key":"YisBBiy2Xm9DEVdFebZ2nbgAHBo="}},{"name":"react-native","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":40,"index":40}}],"key":"KyzuX10g6ixS9UfynhmjlvCIG3g="}},{"name":"../helpers/prompt","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":95},"end":{"line":4,"column":39,"index":134}}],"key":"ma3r8BpcnriAq3WvUfqENHYDi0c="}},{"name":"../loc","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":6,"column":0,"index":199},"end":{"line":6,"column":25,"index":224}}],"key":"kDY1PH2dvsJp7aTUO7XdmHK8aFw="}},{"name":"../class/","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":42},"end":{"line":3,"column":52,"index":94}}],"key":"N3wX6JDXTMVzu+mc1GXPlFmgBv8="}},{"name":"../hooks/useBiometrics","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":5,"column":0,"index":135},"end":{"line":5,"column":63,"index":198}}],"key":"UfOKOCGBKwuDruVQiywBMGv00JU="}}],"output":[{"data":{"code":"__d(function (global, _$$_REQUIRE, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  var _interopRequireDefault = _$$_REQUIRE(_dependencyMap[0], \"@babel/runtime/helpers/interopRequireDefault\");\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.startAndDecrypt = exports.default = void 0;\n  var _asyncToGenerator2 = _interopRequireDefault(_$$_REQUIRE(_dependencyMap[1], \"@babel/runtime/helpers/asyncToGenerator\"));\n  var _reactNative = _$$_REQUIRE(_dependencyMap[2], \"react-native\");\n  var _prompt = _interopRequireDefault(_$$_REQUIRE(_dependencyMap[3], \"../helpers/prompt\"));\n  var _loc = _interopRequireDefault(_$$_REQUIRE(_dependencyMap[4], \"../loc\"));\n  var BlueApp = _$$_REQUIRE(_dependencyMap[5], \"../class/\").BlueApp.getInstance();\n  // If attempt reaches 10, a wipe keychain option will be provided to the user.\n  var unlockAttempt = 0;\n  var _startAndDecrypt = exports.startAndDecrypt = /*#__PURE__*/function () {\n    var _ref = (0, _asyncToGenerator2.default)(function* (retry) {\n      console.log('startAndDecrypt');\n      if (BlueApp.getWallets().length > 0) {\n        console.log('App already has some wallets, so we are in already started state, exiting startAndDecrypt');\n        return true;\n      }\n      yield BlueApp.migrateKeys();\n      var password;\n      if (yield BlueApp.storageIsEncrypted()) {\n        do {\n          password = yield (0, _prompt.default)(retry && _loc.default._.bad_password || _loc.default._.enter_password, _loc.default._.storage_is_encrypted, false);\n        } while (!password);\n      }\n      var success = false;\n      var wasException = false;\n      try {\n        success = yield BlueApp.loadFromDisk(password);\n      } catch (error) {\n        // in case of exception reading from keystore, lets retry instead of assuming there is no storage and\n        // proceeding with no wallets\n        console.warn('exception loading from disk:', error);\n        wasException = true;\n      }\n      if (wasException) {\n        // retrying, but only once\n        try {\n          yield new Promise(function (resolve) {\n            return setTimeout(resolve, 3000);\n          }); // sleep\n          success = yield BlueApp.loadFromDisk(password);\n        } catch (error) {\n          console.warn('second exception loading from disk:', error);\n        }\n      }\n      if (success) {\n        console.log('loaded from disk');\n        // We want to return true to let the UnlockWith screen that its ok to proceed.\n        return true;\n      }\n      if (password) {\n        // we had password and yet could not load/decrypt\n        unlockAttempt++;\n        if (unlockAttempt < 10 || _reactNative.Platform.OS !== 'ios') {\n          return _startAndDecrypt(true);\n        } else {\n          unlockAttempt = 0;\n          (0, _$$_REQUIRE(_dependencyMap[6], \"../hooks/useBiometrics\").showKeychainWipeAlert)();\n          // We want to return false to let the UnlockWith screen that it is NOT ok to proceed.\n          return false;\n        }\n      } else {\n        unlockAttempt = 0;\n        // Return true because there was no wallet data in keychain. Proceed.\n        return true;\n      }\n    });\n    return function startAndDecrypt(_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n  var _default = exports.default = BlueApp;\n});","lineCount":76,"map":[[8,2,1,0],[8,6,1,0,"_reactNative"],[8,18,1,0],[8,21,1,0,"_$$_REQUIRE"],[8,32,1,0],[8,33,1,0,"_dependencyMap"],[8,47,1,0],[9,2,4,0],[9,6,4,0,"_prompt"],[9,13,4,0],[9,16,4,0,"_interopRequireDefault"],[9,38,4,0],[9,39,4,0,"_$$_REQUIRE"],[9,50,4,0],[9,51,4,0,"_dependencyMap"],[9,65,4,0],[10,2,6,0],[10,6,6,0,"_loc"],[10,10,6,0],[10,13,6,0,"_interopRequireDefault"],[10,35,6,0],[10,36,6,0,"_$$_REQUIRE"],[10,47,6,0],[10,48,6,0,"_dependencyMap"],[10,62,6,0],[11,2,8,0],[11,6,8,6,"BlueApp"],[11,13,8,13],[11,16,8,16,"BlueAppClass"],[11,46,8,16],[11,47,8,16,"BlueAppClass"],[11,67,8,28],[11,68,8,29,"getInstance"],[11,79,8,40],[11,80,8,41],[11,81,8,42],[12,2,9,0],[13,2,10,0],[13,6,10,4,"unlockAttempt"],[13,19,10,17],[13,22,10,20],[13,23,10,21],[14,2,12,7],[14,6,12,13,"startAndDecrypt"],[14,22,12,28],[14,25,12,28,"exports"],[14,32,12,28],[14,33,12,28,"startAndDecrypt"],[14,48,12,28],[15,4,12,28],[15,8,12,28,"_ref"],[15,12,12,28],[15,19,12,28,"_asyncToGenerator2"],[15,37,12,28],[15,38,12,28,"default"],[15,45,12,28],[15,47,12,31],[15,58,12,38,"retry"],[15,63,12,53],[15,65,12,76],[16,6,13,2,"console"],[16,13,13,9],[16,14,13,10,"log"],[16,17,13,13],[16,18,13,14],[16,35,13,31],[16,36,13,32],[17,6,14,2],[17,10,14,6,"BlueApp"],[17,17,14,13],[17,18,14,14,"getWallets"],[17,28,14,24],[17,29,14,25],[17,30,14,26],[17,31,14,27,"length"],[17,37,14,33],[17,40,14,36],[17,41,14,37],[17,43,14,39],[18,8,15,4,"console"],[18,15,15,11],[18,16,15,12,"log"],[18,19,15,15],[18,20,15,16],[18,111,15,107],[18,112,15,108],[19,8,16,4],[19,15,16,11],[19,19,16,15],[20,6,17,2],[21,6,18,2],[21,12,18,8,"BlueApp"],[21,19,18,15],[21,20,18,16,"migrateKeys"],[21,31,18,27],[21,32,18,28],[21,33,18,29],[22,6,19,2],[22,10,19,6,"password"],[22,18,19,34],[23,6,20,2],[23,16,20,12,"BlueApp"],[23,23,20,19],[23,24,20,20,"storageIsEncrypted"],[23,42,20,38],[23,43,20,39],[23,44,20,40],[23,46,20,42],[24,8,21,4],[24,11,21,7],[25,10,22,6,"password"],[25,18,22,14],[25,27,22,23],[25,31,22,23,"prompt"],[25,46,22,29],[25,48,22,31,"retry"],[25,53,22,36],[25,57,22,40,"loc"],[25,69,22,43],[25,70,22,44,"_"],[25,71,22,45],[25,72,22,46,"bad_password"],[25,84,22,58],[25,88,22,63,"loc"],[25,100,22,66],[25,101,22,67,"_"],[25,102,22,68],[25,103,22,69,"enter_password"],[25,117,22,83],[25,119,22,85,"loc"],[25,131,22,88],[25,132,22,89,"_"],[25,133,22,90],[25,134,22,91,"storage_is_encrypted"],[25,154,22,111],[25,156,22,113],[25,161,22,118],[25,162,22,119],[26,8,23,4],[26,9,23,5],[26,17,23,13],[26,18,23,14,"password"],[26,26,23,22],[27,6,24,2],[28,6,25,2],[28,10,25,6,"success"],[28,17,25,13],[28,20,25,16],[28,25,25,21],[29,6,26,2],[29,10,26,6,"wasException"],[29,22,26,18],[29,25,26,21],[29,30,26,26],[30,6,27,2],[30,10,27,6],[31,8,28,4,"success"],[31,15,28,11],[31,24,28,20,"BlueApp"],[31,31,28,27],[31,32,28,28,"loadFromDisk"],[31,44,28,40],[31,45,28,41,"password"],[31,53,28,49],[31,54,28,50],[32,6,29,2],[32,7,29,3],[32,8,29,4],[32,15,29,11,"error"],[32,20,29,16],[32,22,29,18],[33,8,30,4],[34,8,31,4],[35,8,32,4,"console"],[35,15,32,11],[35,16,32,12,"warn"],[35,20,32,16],[35,21,32,17],[35,51,32,47],[35,53,32,49,"error"],[35,58,32,54],[35,59,32,55],[36,8,33,4,"wasException"],[36,20,33,16],[36,23,33,19],[36,27,33,23],[37,6,34,2],[38,6,36,2],[38,10,36,6,"wasException"],[38,22,36,18],[38,24,36,20],[39,8,37,4],[40,8,38,4],[40,12,38,8],[41,10,39,6],[41,16,39,12],[41,20,39,16,"Promise"],[41,27,39,23],[41,28,39,24],[41,38,39,24,"resolve"],[41,45,39,31],[42,12,39,31],[42,19,39,35,"setTimeout"],[42,29,39,45],[42,30,39,46,"resolve"],[42,37,39,53],[42,39,39,55],[42,43,39,59],[42,44,39,60],[43,10,39,60],[43,12,39,61],[43,13,39,62],[43,14,39,63],[44,10,40,6,"success"],[44,17,40,13],[44,26,40,22,"BlueApp"],[44,33,40,29],[44,34,40,30,"loadFromDisk"],[44,46,40,42],[44,47,40,43,"password"],[44,55,40,51],[44,56,40,52],[45,8,41,4],[45,9,41,5],[45,10,41,6],[45,17,41,13,"error"],[45,22,41,18],[45,24,41,20],[46,10,42,6,"console"],[46,17,42,13],[46,18,42,14,"warn"],[46,22,42,18],[46,23,42,19],[46,60,42,56],[46,62,42,58,"error"],[46,67,42,63],[46,68,42,64],[47,8,43,4],[48,6,44,2],[49,6,46,2],[49,10,46,6,"success"],[49,17,46,13],[49,19,46,15],[50,8,47,4,"console"],[50,15,47,11],[50,16,47,12,"log"],[50,19,47,15],[50,20,47,16],[50,38,47,34],[50,39,47,35],[51,8,48,4],[52,8,49,4],[52,15,49,11],[52,19,49,15],[53,6,50,2],[54,6,52,2],[54,10,52,6,"password"],[54,18,52,14],[54,20,52,16],[55,8,53,4],[56,8,54,4,"unlockAttempt"],[56,21,54,17],[56,23,54,19],[57,8,55,4],[57,12,55,8,"unlockAttempt"],[57,25,55,21],[57,28,55,24],[57,30,55,26],[57,34,55,30,"Platform"],[57,55,55,38],[57,56,55,39,"OS"],[57,58,55,41],[57,63,55,46],[57,68,55,51],[57,70,55,53],[58,10,56,6],[58,17,56,13,"startAndDecrypt"],[58,33,56,28],[58,34,56,29],[58,38,56,33],[58,39,56,34],[59,8,57,4],[59,9,57,5],[59,15,57,11],[60,10,58,6,"unlockAttempt"],[60,23,58,19],[60,26,58,22],[60,27,58,23],[61,10,59,6],[61,14,59,6,"showKeychainWipeAlert"],[61,44,59,6],[61,45,59,6,"showKeychainWipeAlert"],[61,92,59,27],[61,94,59,28],[61,95,59,29],[62,10,60,6],[63,10,61,6],[63,17,61,13],[63,22,61,18],[64,8,62,4],[65,6,63,2],[65,7,63,3],[65,13,63,9],[66,8,64,4,"unlockAttempt"],[66,21,64,17],[66,24,64,20],[66,25,64,21],[67,8,65,4],[68,8,66,4],[68,15,66,11],[68,19,66,15],[69,6,67,2],[70,4,68,0],[70,5,68,1],[71,4,68,1],[71,20,12,13,"startAndDecrypt"],[71,35,12,28,"startAndDecrypt"],[71,36,12,28,"_x"],[71,38,12,28],[72,6,12,28],[72,13,12,28,"_ref"],[72,17,12,28],[72,18,12,28,"apply"],[72,23,12,28],[72,30,12,28,"arguments"],[72,39,12,28],[73,4,12,28],[74,2,12,28],[74,5,68,1],[75,2,68,2],[75,6,68,2,"_default"],[75,14,68,2],[75,17,68,2,"exports"],[75,24,68,2],[75,25,68,2,"default"],[75,32,68,2],[75,35,70,15,"BlueApp"],[75,42,70,22],[76,0,70,22],[76,3]],"functionMap":{"names":["<global>","startAndDecrypt","Promise$argument_0"],"mappings":"AAA;+BCW;wBC2B,oCD;CD6B"}},"type":"js/module"}]}