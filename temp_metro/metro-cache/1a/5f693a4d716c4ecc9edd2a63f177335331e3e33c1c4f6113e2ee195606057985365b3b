{"dependencies":[{"name":"../../../errors","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":6,"column":33,"index":170},"end":{"line":6,"column":59,"index":196}}],"key":"qo8P6ncfoScjryDx4l+xmXlm9pw="}}],"output":[{"data":{"code":"__d(function (global, _$$_REQUIRE, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  // Ported from https://github.com/mafintosh/end-of-stream with\n  // permission from the author, Mathias Buus (@mafintosh).\n\n  'use strict';\n\n  var ERR_STREAM_PREMATURE_CLOSE = _$$_REQUIRE(_dependencyMap[0], \"../../../errors\").codes.ERR_STREAM_PREMATURE_CLOSE;\n  function once(callback) {\n    var called = false;\n    return function () {\n      if (called) return;\n      called = true;\n      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n      callback.apply(this, args);\n    };\n  }\n  function noop() {}\n  function isRequest(stream) {\n    return stream.setHeader && typeof stream.abort === 'function';\n  }\n  function eos(stream, opts, callback) {\n    if (typeof opts === 'function') return eos(stream, null, opts);\n    if (!opts) opts = {};\n    callback = once(callback || noop);\n    var readable = opts.readable || opts.readable !== false && stream.readable;\n    var writable = opts.writable || opts.writable !== false && stream.writable;\n    var onlegacyfinish = function onlegacyfinish() {\n      if (!stream.writable) onfinish();\n    };\n    var writableEnded = stream._writableState && stream._writableState.finished;\n    var onfinish = function onfinish() {\n      writable = false;\n      writableEnded = true;\n      if (!readable) callback.call(stream);\n    };\n    var readableEnded = stream._readableState && stream._readableState.endEmitted;\n    var onend = function onend() {\n      readable = false;\n      readableEnded = true;\n      if (!writable) callback.call(stream);\n    };\n    var onerror = function onerror(err) {\n      callback.call(stream, err);\n    };\n    var onclose = function onclose() {\n      var err;\n      if (readable && !readableEnded) {\n        if (!stream._readableState || !stream._readableState.ended) err = new ERR_STREAM_PREMATURE_CLOSE();\n        return callback.call(stream, err);\n      }\n      if (writable && !writableEnded) {\n        if (!stream._writableState || !stream._writableState.ended) err = new ERR_STREAM_PREMATURE_CLOSE();\n        return callback.call(stream, err);\n      }\n    };\n    var onrequest = function onrequest() {\n      stream.req.on('finish', onfinish);\n    };\n    if (isRequest(stream)) {\n      stream.on('complete', onfinish);\n      stream.on('abort', onclose);\n      if (stream.req) onrequest();else stream.on('request', onrequest);\n    } else if (writable && !stream._writableState) {\n      // legacy streams\n      stream.on('end', onlegacyfinish);\n      stream.on('close', onlegacyfinish);\n    }\n    stream.on('end', onend);\n    stream.on('finish', onfinish);\n    if (opts.error !== false) stream.on('error', onerror);\n    stream.on('close', onclose);\n    return function () {\n      stream.removeListener('complete', onfinish);\n      stream.removeListener('abort', onclose);\n      stream.removeListener('request', onrequest);\n      if (stream.req) stream.req.removeListener('finish', onfinish);\n      stream.removeListener('end', onlegacyfinish);\n      stream.removeListener('close', onlegacyfinish);\n      stream.removeListener('finish', onfinish);\n      stream.removeListener('end', onend);\n      stream.removeListener('error', onerror);\n      stream.removeListener('close', onclose);\n    };\n  }\n  module.exports = eos;\n});","lineCount":88,"map":[[2,2,1,0],[3,2,2,0],[5,2,4,0],[5,14,4,12],[7,2,6,0],[7,6,6,4,"ERR_STREAM_PREMATURE_CLOSE"],[7,32,6,30],[7,35,6,33,"require"],[7,46,6,40],[7,47,6,40,"_dependencyMap"],[7,61,6,40],[7,83,6,58],[7,84,6,59],[7,85,6,60,"codes"],[7,90,6,65],[7,91,6,66,"ERR_STREAM_PREMATURE_CLOSE"],[7,117,6,92],[8,2,7,0],[8,11,7,9,"once"],[8,15,7,13,"once"],[8,16,7,14,"callback"],[8,24,7,22],[8,26,7,24],[9,4,8,2],[9,8,8,6,"called"],[9,14,8,12],[9,17,8,15],[9,22,8,20],[10,4,9,2],[10,11,9,9],[10,23,9,21],[11,6,10,4],[11,10,10,8,"called"],[11,16,10,14],[11,18,10,16],[12,6,11,4,"called"],[12,12,11,10],[12,15,11,13],[12,19,11,17],[13,6,12,4],[13,11,12,9],[13,15,12,13,"_len"],[13,19,12,17],[13,22,12,20,"arguments"],[13,31,12,29],[13,32,12,30,"length"],[13,38,12,36],[13,40,12,38,"args"],[13,44,12,42],[13,47,12,45],[13,51,12,49,"Array"],[13,56,12,54],[13,57,12,55,"_len"],[13,61,12,59],[13,62,12,60],[13,64,12,62,"_key"],[13,68,12,66],[13,71,12,69],[13,72,12,70],[13,74,12,72,"_key"],[13,78,12,76],[13,81,12,79,"_len"],[13,85,12,83],[13,87,12,85,"_key"],[13,91,12,89],[13,93,12,91],[13,95,12,93],[14,8,13,6,"args"],[14,12,13,10],[14,13,13,11,"_key"],[14,17,13,15],[14,18,13,16],[14,21,13,19,"arguments"],[14,30,13,28],[14,31,13,29,"_key"],[14,35,13,33],[14,36,13,34],[15,6,14,4],[16,6,15,4,"callback"],[16,14,15,12],[16,15,15,13,"apply"],[16,20,15,18],[16,21,15,19],[16,25,15,23],[16,27,15,25,"args"],[16,31,15,29],[16,32,15,30],[17,4,16,2],[17,5,16,3],[18,2,17,0],[19,2,18,0],[19,11,18,9,"noop"],[19,15,18,13,"noop"],[19,16,18,13],[19,18,18,16],[19,19,18,17],[20,2,19,0],[20,11,19,9,"isRequest"],[20,20,19,18,"isRequest"],[20,21,19,19,"stream"],[20,27,19,25],[20,29,19,27],[21,4,20,2],[21,11,20,9,"stream"],[21,17,20,15],[21,18,20,16,"setHeader"],[21,27,20,25],[21,31,20,29],[21,38,20,36,"stream"],[21,44,20,42],[21,45,20,43,"abort"],[21,50,20,48],[21,55,20,53],[21,65,20,63],[22,2,21,0],[23,2,22,0],[23,11,22,9,"eos"],[23,14,22,12,"eos"],[23,15,22,13,"stream"],[23,21,22,19],[23,23,22,21,"opts"],[23,27,22,25],[23,29,22,27,"callback"],[23,37,22,35],[23,39,22,37],[24,4,23,2],[24,8,23,6],[24,15,23,13,"opts"],[24,19,23,17],[24,24,23,22],[24,34,23,32],[24,36,23,34],[24,43,23,41,"eos"],[24,46,23,44],[24,47,23,45,"stream"],[24,53,23,51],[24,55,23,53],[24,59,23,57],[24,61,23,59,"opts"],[24,65,23,63],[24,66,23,64],[25,4,24,2],[25,8,24,6],[25,9,24,7,"opts"],[25,13,24,11],[25,15,24,13,"opts"],[25,19,24,17],[25,22,24,20],[25,23,24,21],[25,24,24,22],[26,4,25,2,"callback"],[26,12,25,10],[26,15,25,13,"once"],[26,19,25,17],[26,20,25,18,"callback"],[26,28,25,26],[26,32,25,30,"noop"],[26,36,25,34],[26,37,25,35],[27,4,26,2],[27,8,26,6,"readable"],[27,16,26,14],[27,19,26,17,"opts"],[27,23,26,21],[27,24,26,22,"readable"],[27,32,26,30],[27,36,26,34,"opts"],[27,40,26,38],[27,41,26,39,"readable"],[27,49,26,47],[27,54,26,52],[27,59,26,57],[27,63,26,61,"stream"],[27,69,26,67],[27,70,26,68,"readable"],[27,78,26,76],[28,4,27,2],[28,8,27,6,"writable"],[28,16,27,14],[28,19,27,17,"opts"],[28,23,27,21],[28,24,27,22,"writable"],[28,32,27,30],[28,36,27,34,"opts"],[28,40,27,38],[28,41,27,39,"writable"],[28,49,27,47],[28,54,27,52],[28,59,27,57],[28,63,27,61,"stream"],[28,69,27,67],[28,70,27,68,"writable"],[28,78,27,76],[29,4,28,2],[29,8,28,6,"onlegacyfinish"],[29,22,28,20],[29,25,28,23],[29,34,28,32,"onlegacyfinish"],[29,48,28,46,"onlegacyfinish"],[29,49,28,46],[29,51,28,49],[30,6,29,4],[30,10,29,8],[30,11,29,9,"stream"],[30,17,29,15],[30,18,29,16,"writable"],[30,26,29,24],[30,28,29,26,"onfinish"],[30,36,29,34],[30,37,29,35],[30,38,29,36],[31,4,30,2],[31,5,30,3],[32,4,31,2],[32,8,31,6,"writableEnded"],[32,21,31,19],[32,24,31,22,"stream"],[32,30,31,28],[32,31,31,29,"_writableState"],[32,45,31,43],[32,49,31,47,"stream"],[32,55,31,53],[32,56,31,54,"_writableState"],[32,70,31,68],[32,71,31,69,"finished"],[32,79,31,77],[33,4,32,2],[33,8,32,6,"onfinish"],[33,16,32,14],[33,19,32,17],[33,28,32,26,"onfinish"],[33,36,32,34,"onfinish"],[33,37,32,34],[33,39,32,37],[34,6,33,4,"writable"],[34,14,33,12],[34,17,33,15],[34,22,33,20],[35,6,34,4,"writableEnded"],[35,19,34,17],[35,22,34,20],[35,26,34,24],[36,6,35,4],[36,10,35,8],[36,11,35,9,"readable"],[36,19,35,17],[36,21,35,19,"callback"],[36,29,35,27],[36,30,35,28,"call"],[36,34,35,32],[36,35,35,33,"stream"],[36,41,35,39],[36,42,35,40],[37,4,36,2],[37,5,36,3],[38,4,37,2],[38,8,37,6,"readableEnded"],[38,21,37,19],[38,24,37,22,"stream"],[38,30,37,28],[38,31,37,29,"_readableState"],[38,45,37,43],[38,49,37,47,"stream"],[38,55,37,53],[38,56,37,54,"_readableState"],[38,70,37,68],[38,71,37,69,"endEmitted"],[38,81,37,79],[39,4,38,2],[39,8,38,6,"onend"],[39,13,38,11],[39,16,38,14],[39,25,38,23,"onend"],[39,30,38,28,"onend"],[39,31,38,28],[39,33,38,31],[40,6,39,4,"readable"],[40,14,39,12],[40,17,39,15],[40,22,39,20],[41,6,40,4,"readableEnded"],[41,19,40,17],[41,22,40,20],[41,26,40,24],[42,6,41,4],[42,10,41,8],[42,11,41,9,"writable"],[42,19,41,17],[42,21,41,19,"callback"],[42,29,41,27],[42,30,41,28,"call"],[42,34,41,32],[42,35,41,33,"stream"],[42,41,41,39],[42,42,41,40],[43,4,42,2],[43,5,42,3],[44,4,43,2],[44,8,43,6,"onerror"],[44,15,43,13],[44,18,43,16],[44,27,43,25,"onerror"],[44,34,43,32,"onerror"],[44,35,43,33,"err"],[44,38,43,36],[44,40,43,38],[45,6,44,4,"callback"],[45,14,44,12],[45,15,44,13,"call"],[45,19,44,17],[45,20,44,18,"stream"],[45,26,44,24],[45,28,44,26,"err"],[45,31,44,29],[45,32,44,30],[46,4,45,2],[46,5,45,3],[47,4,46,2],[47,8,46,6,"onclose"],[47,15,46,13],[47,18,46,16],[47,27,46,25,"onclose"],[47,34,46,32,"onclose"],[47,35,46,32],[47,37,46,35],[48,6,47,4],[48,10,47,8,"err"],[48,13,47,11],[49,6,48,4],[49,10,48,8,"readable"],[49,18,48,16],[49,22,48,20],[49,23,48,21,"readableEnded"],[49,36,48,34],[49,38,48,36],[50,8,49,6],[50,12,49,10],[50,13,49,11,"stream"],[50,19,49,17],[50,20,49,18,"_readableState"],[50,34,49,32],[50,38,49,36],[50,39,49,37,"stream"],[50,45,49,43],[50,46,49,44,"_readableState"],[50,60,49,58],[50,61,49,59,"ended"],[50,66,49,64],[50,68,49,66,"err"],[50,71,49,69],[50,74,49,72],[50,78,49,76,"ERR_STREAM_PREMATURE_CLOSE"],[50,104,49,102],[50,105,49,103],[50,106,49,104],[51,8,50,6],[51,15,50,13,"callback"],[51,23,50,21],[51,24,50,22,"call"],[51,28,50,26],[51,29,50,27,"stream"],[51,35,50,33],[51,37,50,35,"err"],[51,40,50,38],[51,41,50,39],[52,6,51,4],[53,6,52,4],[53,10,52,8,"writable"],[53,18,52,16],[53,22,52,20],[53,23,52,21,"writableEnded"],[53,36,52,34],[53,38,52,36],[54,8,53,6],[54,12,53,10],[54,13,53,11,"stream"],[54,19,53,17],[54,20,53,18,"_writableState"],[54,34,53,32],[54,38,53,36],[54,39,53,37,"stream"],[54,45,53,43],[54,46,53,44,"_writableState"],[54,60,53,58],[54,61,53,59,"ended"],[54,66,53,64],[54,68,53,66,"err"],[54,71,53,69],[54,74,53,72],[54,78,53,76,"ERR_STREAM_PREMATURE_CLOSE"],[54,104,53,102],[54,105,53,103],[54,106,53,104],[55,8,54,6],[55,15,54,13,"callback"],[55,23,54,21],[55,24,54,22,"call"],[55,28,54,26],[55,29,54,27,"stream"],[55,35,54,33],[55,37,54,35,"err"],[55,40,54,38],[55,41,54,39],[56,6,55,4],[57,4,56,2],[57,5,56,3],[58,4,57,2],[58,8,57,6,"onrequest"],[58,17,57,15],[58,20,57,18],[58,29,57,27,"onrequest"],[58,38,57,36,"onrequest"],[58,39,57,36],[58,41,57,39],[59,6,58,4,"stream"],[59,12,58,10],[59,13,58,11,"req"],[59,16,58,14],[59,17,58,15,"on"],[59,19,58,17],[59,20,58,18],[59,28,58,26],[59,30,58,28,"onfinish"],[59,38,58,36],[59,39,58,37],[60,4,59,2],[60,5,59,3],[61,4,60,2],[61,8,60,6,"isRequest"],[61,17,60,15],[61,18,60,16,"stream"],[61,24,60,22],[61,25,60,23],[61,27,60,25],[62,6,61,4,"stream"],[62,12,61,10],[62,13,61,11,"on"],[62,15,61,13],[62,16,61,14],[62,26,61,24],[62,28,61,26,"onfinish"],[62,36,61,34],[62,37,61,35],[63,6,62,4,"stream"],[63,12,62,10],[63,13,62,11,"on"],[63,15,62,13],[63,16,62,14],[63,23,62,21],[63,25,62,23,"onclose"],[63,32,62,30],[63,33,62,31],[64,6,63,4],[64,10,63,8,"stream"],[64,16,63,14],[64,17,63,15,"req"],[64,20,63,18],[64,22,63,20,"onrequest"],[64,31,63,29],[64,32,63,30],[64,33,63,31],[64,34,63,32],[64,39,63,37,"stream"],[64,45,63,43],[64,46,63,44,"on"],[64,48,63,46],[64,49,63,47],[64,58,63,56],[64,60,63,58,"onrequest"],[64,69,63,67],[64,70,63,68],[65,4,64,2],[65,5,64,3],[65,11,64,9],[65,15,64,13,"writable"],[65,23,64,21],[65,27,64,25],[65,28,64,26,"stream"],[65,34,64,32],[65,35,64,33,"_writableState"],[65,49,64,47],[65,51,64,49],[66,6,65,4],[67,6,66,4,"stream"],[67,12,66,10],[67,13,66,11,"on"],[67,15,66,13],[67,16,66,14],[67,21,66,19],[67,23,66,21,"onlegacyfinish"],[67,37,66,35],[67,38,66,36],[68,6,67,4,"stream"],[68,12,67,10],[68,13,67,11,"on"],[68,15,67,13],[68,16,67,14],[68,23,67,21],[68,25,67,23,"onlegacyfinish"],[68,39,67,37],[68,40,67,38],[69,4,68,2],[70,4,69,2,"stream"],[70,10,69,8],[70,11,69,9,"on"],[70,13,69,11],[70,14,69,12],[70,19,69,17],[70,21,69,19,"onend"],[70,26,69,24],[70,27,69,25],[71,4,70,2,"stream"],[71,10,70,8],[71,11,70,9,"on"],[71,13,70,11],[71,14,70,12],[71,22,70,20],[71,24,70,22,"onfinish"],[71,32,70,30],[71,33,70,31],[72,4,71,2],[72,8,71,6,"opts"],[72,12,71,10],[72,13,71,11,"error"],[72,18,71,16],[72,23,71,21],[72,28,71,26],[72,30,71,28,"stream"],[72,36,71,34],[72,37,71,35,"on"],[72,39,71,37],[72,40,71,38],[72,47,71,45],[72,49,71,47,"onerror"],[72,56,71,54],[72,57,71,55],[73,4,72,2,"stream"],[73,10,72,8],[73,11,72,9,"on"],[73,13,72,11],[73,14,72,12],[73,21,72,19],[73,23,72,21,"onclose"],[73,30,72,28],[73,31,72,29],[74,4,73,2],[74,11,73,9],[74,23,73,21],[75,6,74,4,"stream"],[75,12,74,10],[75,13,74,11,"removeListener"],[75,27,74,25],[75,28,74,26],[75,38,74,36],[75,40,74,38,"onfinish"],[75,48,74,46],[75,49,74,47],[76,6,75,4,"stream"],[76,12,75,10],[76,13,75,11,"removeListener"],[76,27,75,25],[76,28,75,26],[76,35,75,33],[76,37,75,35,"onclose"],[76,44,75,42],[76,45,75,43],[77,6,76,4,"stream"],[77,12,76,10],[77,13,76,11,"removeListener"],[77,27,76,25],[77,28,76,26],[77,37,76,35],[77,39,76,37,"onrequest"],[77,48,76,46],[77,49,76,47],[78,6,77,4],[78,10,77,8,"stream"],[78,16,77,14],[78,17,77,15,"req"],[78,20,77,18],[78,22,77,20,"stream"],[78,28,77,26],[78,29,77,27,"req"],[78,32,77,30],[78,33,77,31,"removeListener"],[78,47,77,45],[78,48,77,46],[78,56,77,54],[78,58,77,56,"onfinish"],[78,66,77,64],[78,67,77,65],[79,6,78,4,"stream"],[79,12,78,10],[79,13,78,11,"removeListener"],[79,27,78,25],[79,28,78,26],[79,33,78,31],[79,35,78,33,"onlegacyfinish"],[79,49,78,47],[79,50,78,48],[80,6,79,4,"stream"],[80,12,79,10],[80,13,79,11,"removeListener"],[80,27,79,25],[80,28,79,26],[80,35,79,33],[80,37,79,35,"onlegacyfinish"],[80,51,79,49],[80,52,79,50],[81,6,80,4,"stream"],[81,12,80,10],[81,13,80,11,"removeListener"],[81,27,80,25],[81,28,80,26],[81,36,80,34],[81,38,80,36,"onfinish"],[81,46,80,44],[81,47,80,45],[82,6,81,4,"stream"],[82,12,81,10],[82,13,81,11,"removeListener"],[82,27,81,25],[82,28,81,26],[82,33,81,31],[82,35,81,33,"onend"],[82,40,81,38],[82,41,81,39],[83,6,82,4,"stream"],[83,12,82,10],[83,13,82,11,"removeListener"],[83,27,82,25],[83,28,82,26],[83,35,82,33],[83,37,82,35,"onerror"],[83,44,82,42],[83,45,82,43],[84,6,83,4,"stream"],[84,12,83,10],[84,13,83,11,"removeListener"],[84,27,83,25],[84,28,83,26],[84,35,83,33],[84,37,83,35,"onclose"],[84,44,83,42],[84,45,83,43],[85,4,84,2],[85,5,84,3],[86,2,85,0],[87,2,86,0,"module"],[87,8,86,6],[87,9,86,7,"exports"],[87,16,86,14],[87,19,86,17,"eos"],[87,22,86,20],[88,0,86,21],[88,3]],"functionMap":{"names":["<global>","once","<anonymous>","noop","isRequest","eos","onlegacyfinish","onfinish","onend","onerror","onclose","onrequest"],"mappings":"AAA;ACM;SCE;GDO;CDC;AGC,kBH;AIC;CJE;AKC;uBCM;GDE;iBEE;GFI;cGE;GHI;gBIC;GJE;gBKC;GLU;kBMC;GNE;SHc;GGW;CLC"}},"type":"js/module"}]}